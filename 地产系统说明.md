# 地产系统完整说明

## 📊 核心属性

### 1. 等级系统（Level）
- **范围**：0 - 5 级（5 级满级）
- **初始**：购买时为 0 级
- **升级触发**：每次经过自己的地产时可选择升级（AI 70%自动升级）
- **升级效果**：每升一级，地产价格提升 10%
- **升级成本**：`升级成本 = 当前地价 × 升级成本率 × (1 + CPI)`
  - 升级成本率：20%

### 2. 物价指数（CPI）
- **初始值**：0.0（无影响）
- **范围**：-30% ～ +50%
- **影响**：所有价格、租金、成本都乘以 (1 + CPI)

#### CPI 变化来源
1. **财富变化**：总游戏财富每变化 1000 万元约影响 CPI ±0.01%
2. **突发事件**：CHANCE 事件有 25% 概率触发，浮动范围 ±5%

### 3. 定价公式

#### 地产当前价格
```
property_price = base_price × (1 + level × 0.1) × (1 + CPI)
```

#### 租金
```
rent = property_price × rent_rate
```
- 初始租金率：10%
- 范围：随地产价格和等级浮动

#### 升级成本
```
upgrade_cost = property_price × 0.2 × (1 + CPI)
```

#### 维护成本
```
maintenance_cost = property_price × 0.05 × (1 + CPI)  （仅拥有时，等级>0）
```

## 🎮 游戏流程

### 购买地产
1. 到达无主地产
2. 支付 `base_price × (1 + CPI)` 获得 0 级地产

### 经过自己的地产
1. **检查升级**
   - 如果等级 < 5 且有足够现金
   - AI 70% 自动升级，玩家获得提示（未来支持手动）
   - 等级 +1，支付升级成本
2. **支付维护费**
   - 如果等级 > 0，支付维护成本
   - 维护费不足时需卖地

### 经过他人地产
1. 支付租金（根据当前 CPI 和地产等级计算）
2. 现金不足则进入出售模式逐个卖地

### 突发事件（CHANCE）
- **25% 概率**：物价指数浮动 ±5%
- 影响：所有后续的价格、租金、成本立即更新

## 💰 经济影响

### CPI 正向（物价上升）
- ✅ **优势**：已有地产升值，收租增加
- ❌ **劣势**：升级/维护成本上升，购买成本上升

### CPI 负向（物价下降）
- ✅ **优势**：购买地产便宜，升级/维护成本低
- ❌ **劣势**：已有地产贬值，收租减少

## 📈 示例计算

### 初始状态
- 地产 1：base_price = $600，rent_rate = 10%，CPI = 0%
- property_price = 600 × 1.0 × 1.0 = $600
- rent = 600 × 0.1 = $60

### 升级到 2 级，CPI = 10%
- property_price = 600 × (1 + 0.2) × 1.1 = $792
- rent = 792 × 0.1 = $79.2 ≈ $79
- upgrade_cost = 792 × 0.2 × 1.1 = $174.24 ≈ $174
- maintenance = 792 × 0.05 × 1.1 = $43.56 ≈ $44

## 🎯 策略建议

### 早期（CPI 低时）
- 积极购买地产（便宜）
- 谨慎升级（维护成本低但升值慢）

### 中期（CPI 上升时）
- 升级已有地产（收租快速增长）
- 谨慎购买新地产（成本高）

### 后期（CPI 高时）
- 保护现有资产（维护成本高）
- 优先升级高价值地产（回报高）

## 🔧 配置参数

在 `config.py` 修改：

```python
PROPERTY_MAX_LEVEL = 5                      # 最高等级
PROPERTY_LEVEL_MULTIPLIER = 0.1             # 每级提升 10%
PROPERTY_UPGRADE_RATE = 0.2                 # 升级成本率
PROPERTY_MAINTENANCE_RATE = 0.05            # 维护成本率
PROPERTY_INITIAL_RENT_RATE = 0.1            # 初始租金率

CPI_MIN = -0.3                              # CPI 下限 -30%
CPI_MAX = 0.5                               # CPI 上限 +50%
CPI_CHANGE_PER_TOTAL_WEALTH = 0.00001      # 财富影响系数
CHANCE_CPI_FLUCTUATION = (-0.05, 0.05)    # 突发事件范围
```

## 📝 UI 显示

### 信息面板
- 显示每位玩家的 CPI 百分比
- 显示租金率、利息率、土地税率

### 地块上显示
- 地产等级标签（Lv0-Lv5）
- 悬停提示未来支持地产详细信息

## ⚠️ 注意事项

1. **CPI 实时计算**：价格在每个回合自动更新
2. **维护成本强制**：即使贬值也要支付（考虑破产风险）
3. **升级决策**：AI 自动，玩家未来支持手动选择
4. **出售机制**：现金不足时自动进入出售模式，需逐个出售地产

---

**版本**：1.0  
**最后更新**：2025-10-24
